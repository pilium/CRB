"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}"active"===localStorage.getItem("blind")&&console.log("hell yeah"),window.addEventListener("load",function(){function e(){var e=new Date,t={year:"numeric",month:"long",day:"numeric"};document.querySelector(".js-footer-info__date").innerHTML=e.toLocaleString("ru",t)}function t(){window.scrollY>=q?(document.body.style.paddingTop=y.offsetHeight+"px",y.classList.add("fixed-nav")):(y.classList.remove("fixed-nav"),document.body.style.paddingTop=0)}function o(){if(T.classList.contains("starblind")){_toConsumableArray(x.querySelectorAll("button")).forEach(function(e){e.addEventListener("click",function(){e.hasAttribute("data-value")&&T.classList.toggle(e.getAttribute("data-value"))})})}}var n=document.getElementById("preloader");n&&setTimeout(function(){n.classList.add("active"),document.body.style.overflow="visible"},100);var s=document.querySelector(".js-hero-slider"),a=document.querySelector(".blog-slider"),l=document.querySelector(".news-slider"),r=document.getElementById("map"),i=document.querySelector(".js-header-info__writeToUs-link"),c=document.querySelector(".modal"),d=c.querySelector(".modal-close__btn"),u=c.querySelector("[name=login]"),m=document.querySelector(".wrapper-menu"),f=document.querySelector(".js-sidenav"),g=document.querySelector(".sidenav-overlay"),w=document.getElementsByClassName("acc-header"),v=document.querySelector(".testimonials-slider"),p=document.querySelector(".gallery"),y=document.querySelector("#nav-main");if(function(){var e=document.querySelector(".modal-overlay");i.addEventListener("click",function(t){t.preventDefault(),c.classList.toggle("modal-show"),e.classList.toggle("show"),u.focus()}),d.addEventListener("click",function(t){t.preventDefault(),c.classList.remove("modal-show"),e.classList.toggle("show")}),document.addEventListener("click",function(t){t.target.classList.contains("modal-overlay")&&(c.classList.remove("modal-show"),e.classList.toggle("show"))})}(),s){new Swiper(".swiper-container",{loop:!0,parallax:!0,autoplay:{delay:5e3},speed:1e3,mousewheelControl:!0})}if(a){new Swiper(".blog-slider",{spaceBetween:30,effect:"fade",loop:!0,grabCursor:!0,autoplay:{delay:7e3},pagination:{el:".blog-slider__pagination",clickable:!0}})}if(l){new Swiper(".news-slider",{effect:"coverflow",grabCursor:!0,loop:!1,centeredSlides:!1,keyboard:!0,spaceBetween:10,slidesPerView:"3",speed:300,coverflowEffect:{rotate:0,stretch:0,depth:0,modifier:1,slideShadows:!1},breakpoints:{1230:{slidesPerView:3},900:{slidesPerView:2},650:{slidesPerView:1,spaceBetween:0,centeredSlides:!0}},simulateTouch:!0,navigation:{nextEl:".news-slider-next",prevEl:".news-slider-prev"},pagination:{el:".news-slider__pagination",clickable:!0}})}if(v){new Swiper(v,{autoHeight:!0,loop:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})}if(r){var L=function(){var e=new ymaps.Map("map",{center:[47.5396,42.0151],controls:["typeSelector","fullscreenControl","geolocationControl","rulerControl","routeButtonControl"],zoom:16});e.controls.get("routeButtonControl").routePanel.state.set("from","Романовская союзный 97а");var t=new ymaps.Placemark([47.5398,42.0153],{hintContent:"Ул. Союзная 97а",balloonContent:"Поликлиника"},{preset:"islands#blueMedicalIcon"});e.geoObjects.add(t)};ymaps.ready(L)}setTimeout(e,100),m&&m.addEventListener("click",function(){m.classList.toggle("open"),f.classList.toggle("show"),g.classList.toggle("show")}),document.addEventListener("click",function(e){e.target.classList.contains("sidenav-overlay")&&(m.classList.toggle("open"),f.classList.toggle("show"),g.classList.toggle("show"))});for(var h=0;h<w.length;h++)w[h].addEventListener("click",function(e){e.preventDefault(),this.classList.toggle("active"),this.nextElementSibling.classList.toggle("active")});!function(){for(var e=document.querySelectorAll(".material-card > .mc-btn-action"),t=0;t<e.length;t++)e[t].addEventListener("click",function(){var e=this.parentNode,t=this.querySelector("i");t.classList.add("fa-spin-fast"),e.classList.contains("mc-active")?(e.classList.remove("mc-active"),setTimeout(function(){t.classList.remove("fa-arrow-left"),t.classList.remove("fa-spin-fast"),t.classList.add("fa-bars")},800)):(e.classList.add("mc-active"),setTimeout(function(){t.classList.remove("fa-bars"),t.classList.remove("fa-spin-fast"),t.classList.add("fa-arrow-left")},800))})}(),p&&baguetteBox.run(".gallery-wrap",{async:!0});for(var b=document.querySelectorAll("form"),S=0;S<b.length;S++)!function(e){b[e].onsubmit=function(t){t.preventDefault(),b[e].classList.add("signed")}}(S);var q=y.offsetTop;window.addEventListener("scroll",t);for(var E=document.querySelectorAll(".fixed-width"),A=0;A<E.length;A++)!function(e){E[e].addEventListener("keyup",function(t){if(13===t.keyCode){var o=E[e].querySelector(".menu");E[e].classList.toggle("fixed-width--show"),o.addEventListener("blur",function(){o.style.display="none"})}})}(A);var _=document.querySelector(".js-starblind-trigger"),T=document.querySelector("body"),k=document.querySelectorAll(".js-sliderNews--blind"),j=document.querySelector(".js-blindTestimonials"),x=document.querySelector(".js-blindHeaderPanel");_.addEventListener("click",function(){if(localStorage.setItem("blind","active"),x.classList.toggle("blindHeaderPanel--show"),T.classList.toggle("starblind"),j&&j.classList.toggle("cd-testimonials__blind--show"),k)for(var e=0;e<k.length;e++)k[e].classList.toggle("blindSliderNews--show");o()})}),function(){function e(){var e=window.scrollY||document.documentElement.scrollTop;e>l?n(a,"cd-top--show"):s(a,"cd-top--show","cd-top--fade-out"),e>r&&n(a,"cd-top--fade-out"),i=!1}function t(e){var t=window.scrollY||document.documentElement.scrollTop,o=null,n=function n(s){o||(o=s);var a=s-o,l=Math.max(Math.easeInOutQuad(a,t,-t,e),0);window.scrollTo(0,l),a<e&&window.requestAnimationFrame(n)};window.requestAnimationFrame(n)}function o(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)".concat(t,"(\\s|$)")))}function n(e,t){var s=t.split(" ");e.classList?e.classList.add(s[0]):o(e,s[0])||(e.className+=" ".concat(s[0])),s.length>1&&n(e,s.slice(1).join(" "))}function s(e,t){var n=t.split(" ");if(e.classList)e.classList.remove(n[0]);else if(o(e,n[0])){var a=new RegExp("(\\s|^)".concat(n[0],"(\\s|$)"));e.className=e.className.replace(a," ")}n.length>1&&s(e,n.slice(1).join(" "))}var a=document.getElementsByClassName("js-cd-top")[0],l=300,r=1200,i=!1;a&&(window.addEventListener("scroll",function(t){i||(i=!0,window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,250))}),a.addEventListener("click",function(e){e.preventDefault(),window.requestAnimationFrame?t(700):window.scrollTo(0,0)})),Math.easeInOutQuad=function(e,t,o,n){return(e/=n/2)<1?o/2*e*e+t:(e--,-o/2*(e*(e-2)-1)+t)}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbW1vbi5qcyJdLCJuYW1lcyI6WyJfdG9Db25zdW1hYmxlQXJyYXkiLCJhcnIiLCJfYXJyYXlXaXRob3V0SG9sZXMiLCJfaXRlcmFibGVUb0FycmF5IiwiX25vbkl0ZXJhYmxlU3ByZWFkIiwiVHlwZUVycm9yIiwiaXRlciIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiT2JqZWN0IiwicHJvdG90eXBlIiwidG9TdHJpbmciLCJjYWxsIiwiQXJyYXkiLCJmcm9tIiwiaXNBcnJheSIsImkiLCJhcnIyIiwibGVuZ3RoIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImNvbnNvbGUiLCJsb2ciLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiYWRkVGltZUZvb3RlciIsImRhdGUiLCJEYXRlIiwib3B0aW9ucyIsInllYXIiLCJtb250aCIsImRheSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImlubmVySFRNTCIsInRvTG9jYWxlU3RyaW5nIiwiZml4TmF2Iiwic2Nyb2xsWSIsInRvcE9mTmF2IiwiYm9keSIsInN0eWxlIiwicGFkZGluZ1RvcCIsIm5hdiIsIm9mZnNldEhlaWdodCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInRlc3QiLCJjb250YWlucyIsImJsaW5kUGFuZWwiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImJ1dHRvbiIsImhhc0F0dHJpYnV0ZSIsInRvZ2dsZSIsImdldEF0dHJpYnV0ZSIsInByZWxvYWRlciIsImdldEVsZW1lbnRCeUlkIiwic2V0VGltZW91dCIsIm92ZXJmbG93Iiwic2xpZGVyQ29udGFpbmVyIiwiYmxvZ1NsaWRlciIsIm5ld3NTbGlkZXIiLCJtYXBDb250YWluZXIiLCJsaW5rIiwicG9wdXAiLCJjbG9zZSIsImxvZ2luIiwid3JhcHBlck1lbnUiLCJzaWRlbmF2Iiwib3ZlcmxheSIsImFjYyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJ0ZXN0aW1vbmlhbHNTbGlkZXIiLCJnYWxsZXJ5IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsImZvY3VzIiwiZSIsInRhcmdldCIsIlN3aXBlciIsImxvb3AiLCJwYXJhbGxheCIsImF1dG9wbGF5IiwiZGVsYXkiLCJzcGVlZCIsIm1vdXNld2hlZWxDb250cm9sIiwic3BhY2VCZXR3ZWVuIiwiZWZmZWN0IiwiZ3JhYkN1cnNvciIsInBhZ2luYXRpb24iLCJlbCIsImNsaWNrYWJsZSIsImNlbnRlcmVkU2xpZGVzIiwia2V5Ym9hcmQiLCJzbGlkZXNQZXJWaWV3IiwiY292ZXJmbG93RWZmZWN0Iiwicm90YXRlIiwic3RyZXRjaCIsImRlcHRoIiwibW9kaWZpZXIiLCJzbGlkZVNoYWRvd3MiLCJicmVha3BvaW50cyIsIjEyMzAiLCI5MDAiLCI2NTAiLCJzaW11bGF0ZVRvdWNoIiwibmF2aWdhdGlvbiIsIm5leHRFbCIsInByZXZFbCIsImF1dG9IZWlnaHQiLCJpbml0IiwibXlNYXAiLCJ5bWFwcyIsIk1hcCIsImNlbnRlciIsImNvbnRyb2xzIiwiem9vbSIsImdldCIsInJvdXRlUGFuZWwiLCJzdGF0ZSIsInNldCIsIm15UGxhY2VtYXJrIiwiUGxhY2VtYXJrIiwiaGludENvbnRlbnQiLCJiYWxsb29uQ29udGVudCIsInByZXNldCIsImdlb09iamVjdHMiLCJyZWFkeSIsInRoaXMiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJwZW9wbGVDYXJkIiwiX2kiLCJjYXJkIiwicGFyZW50Tm9kZSIsImljb24iLCJiYWd1ZXR0ZUJveCIsInJ1biIsImFzeW5jIiwiZm9ybXMiLCJfaTIiLCJvbnN1Ym1pdCIsIm9mZnNldFRvcCIsImRyb3Bkb3duSXRlbXMiLCJfaTMiLCJrZXlDb2RlIiwic3ViTWVudSIsImRpc3BsYXkiLCJibGluZHRyaWdnZXIiLCJzbGlkZXJOZXdzQmxpbmQiLCJ0ZXN0aW1vbmFsc0JsaW5kIiwic2V0SXRlbSIsIl9pNCIsImNoZWNrQmFja1RvVG9wIiwid2luZG93VG9wIiwiZG9jdW1lbnRFbGVtZW50Iiwic2Nyb2xsVG9wIiwib2Zmc2V0IiwiYWRkQ2xhc3MiLCJiYWNrVG9wIiwicmVtb3ZlQ2xhc3MiLCJvZmZzZXRPcGFjaXR5Iiwic2Nyb2xsaW5nIiwiZHVyYXRpb24iLCJzdGFydCIsImN1cnJlbnRUaW1lIiwiYW5pbWF0ZVNjcm9sbCIsInRpbWVzdGFtcCIsInByb2dyZXNzIiwidmFsIiwiTWF0aCIsIm1heCIsImVhc2VJbk91dFF1YWQiLCJzY3JvbGxUbyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImhhc0NsYXNzIiwiY2xhc3NOYW1lIiwibWF0Y2giLCJSZWdFeHAiLCJjb25jYXQiLCJzcGxpdCIsInNsaWNlIiwiam9pbiIsInJlZyIsInJlcGxhY2UiLCJ0IiwiYiIsImMiLCJkIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUVBLFNBQUFBLG9CQUFBQyxHQUFBLE1BQUFDLG9CQUFBRCxJQUFBRSxpQkFBQUYsSUFBQUcscUJBRUEsUUFBQUEsc0JBQUEsS0FBQSxJQUFBQyxXQUFBLG1EQUVBLFFBQUFGLGtCQUFBRyxHQUFBLEdBQUFDLE9BQUFDLFdBQUFDLFFBQUFILElBQUEsdUJBQUFHLE9BQUFDLFVBQUFDLFNBQUFDLEtBQUFOLEdBQUEsTUFBQU8sT0FBQUMsS0FBQVIsR0FFQSxRQUFBSixvQkFBQUQsR0FBQSxHQUFBWSxNQUFBRSxRQUFBZCxHQUFBLENBQUEsSUFBQSxHQUFBZSxHQUFBLEVBQUFDLEVBQUEsR0FBQUosT0FBQVosRUFBQWlCLFFBQUFGLEVBQUFmLEVBQUFpQixPQUFBRixJQUFBQyxFQUFBRCxHQUFBZixFQUFBZSxFQUFBLE9BQUFDLElBRUEsV0FBQUUsYUFBQUMsUUFBQSxVQUNBQyxRQUFBQyxJQUFBLGFBR0FDLE9BQUFDLGlCQUFBLE9BQUEsV0ErSkEsUUFBQUMsS0FDQSxHQUFBQyxHQUFBLEdBQUFDLE1BQ0FDLEdBQ0FDLEtBQUEsVUFDQUMsTUFBQSxPQUNBQyxJQUFBLFVBRUFDLFVBQUFDLGNBQUEseUJBQ0FDLFVBQUFSLEVBQUFTLGVBQUEsS0FBQVAsR0E0RkEsUUFBQVEsS0FDQWIsT0FBQWMsU0FBQUMsR0FDQU4sU0FBQU8sS0FB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QUFBcUYsV0FBQSxJQUFBRyxPQUFBdkksRUFBQSxLQUNBQSxFQUFBMUIsT0FBQSxHQUFBNEksRUFBQW5FLEVBQUEvQyxFQUFBeUksTUFBQSxHQUFBQyxLQUFBLE1BR0EsUUFBQXRCLEdBQUFyRSxFQUFBcUYsR0FDQSxHQUFBcEksR0FBQW9JLEVBQUFJLE1BQUEsSUFDQSxJQUFBekYsRUFBQS9DLFVBQUErQyxFQUFBL0MsVUFBQUUsT0FBQUYsRUFBQSxRQUFBLElBQUFtSSxFQUFBcEYsRUFBQS9DLEVBQUEsSUFBQSxDQUNBLEdBQUEySSxHQUFBLEdBQUFMLFFBQUEsVUFBQUMsT0FBQXZJLEVBQUEsR0FBQSxXQUNBK0MsR0FBQXFGLFVBQUFyRixFQUFBcUYsVUFBQVEsUUFBQUQsRUFBQSxLQUVBM0ksRUFBQTFCLE9BQUEsR0FBQThJLEVBQUFyRSxFQUFBL0MsRUFBQXlJLE1BQUEsR0FBQUMsS0FBQSxNQXJFQSxHQUFBdkIsR0FBQS9ILFNBQUF3Qyx1QkFBQSxhQUFBLEdBQ0FxRixFQUFBLElBQ0FJLEVBQUEsS0FFQUMsR0FBQSxDQUVBSCxLQUNBeEksT0FBQUMsaUJBQUEsU0FBQSxTQUFBbUQsR0FDQXVGLElBQ0FBLEdBQUEsRUFDQTNJLE9BQUF1SixzQkFBQXZKLE9BQUF1SixzQkFBQXJCLEdBQUEvRixXQUFBK0YsRUFBQSxRQUlBTSxFQUFBdkksaUJBQUEsUUFBQSxTQUFBbUQsR0FDQUEsRUFBQUMsaUJBQ0FyRCxPQUFBdUosc0JBQUFsQixFQWJBLEtBYUFySSxPQUFBc0osU0FBQSxFQUFBLE1BNkJBSCxLQUFBRSxjQUFBLFNBQUFhLEVBQUFDLEVBQUFDLEVBQUFDLEdBRUEsT0FEQUgsR0FBQUcsRUFBQSxHQUNBLEVBQUFELEVBQUEsRUFBQUYsRUFBQUEsRUFBQUMsR0FDQUQsS0FDQUUsRUFBQSxHQUFBRixHQUFBQSxFQUFBLEdBQUEsR0FBQUMiLCJmaWxlIjoic2NyaXB0cy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyByZXR1cm4gX2FycmF5V2l0aG91dEhvbGVzKGFycikgfHwgX2l0ZXJhYmxlVG9BcnJheShhcnIpIHx8IF9ub25JdGVyYWJsZVNwcmVhZCgpOyB9XG5cbmZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlXCIpOyB9XG5cbmZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikgeyBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaXRlcikgPT09IFwiW29iamVjdCBBcmd1bWVudHNdXCIpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpOyB9XG5cbmZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgeyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9IH1cblxuaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdibGluZCcpID09PSAnYWN0aXZlJykge1xuICBjb25zb2xlLmxvZygnaGVsbCB5ZWFoJyk7XG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24gKCkge1xuICAvLyBwcmVsb2FkZXJcbiAgdmFyIHByZWxvYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmVsb2FkZXInKTtcblxuICBpZiAocHJlbG9hZGVyKSB7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBwcmVsb2FkZXIuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJ3Zpc2libGUnO1xuICAgIH0sIDEwMCk7XG4gIH0gLy8gRU5EIFByZWxvYWRlclxuXG5cbiAgdmFyIHNsaWRlckNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1oZXJvLXNsaWRlcicpO1xuICB2YXIgYmxvZ1NsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ibG9nLXNsaWRlcicpO1xuICB2YXIgbmV3c1NsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXdzLXNsaWRlcicpO1xuICB2YXIgbWFwQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpO1xuICB2YXIgbGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1oZWFkZXItaW5mb19fd3JpdGVUb1VzLWxpbmsnKTtcbiAgdmFyIHBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsJyk7XG4gIHZhciBjbG9zZSA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1jbG9zZV9fYnRuJyk7XG4gIHZhciBsb2dpbiA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoJ1tuYW1lPWxvZ2luXScpO1xuICB2YXIgd3JhcHBlck1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud3JhcHBlci1tZW51Jyk7XG4gIHZhciBzaWRlbmF2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLXNpZGVuYXYnKTtcbiAgdmFyIG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2lkZW5hdi1vdmVybGF5Jyk7XG4gIHZhciBhY2MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdhY2MtaGVhZGVyJyk7XG4gIHZhciB0ZXN0aW1vbmlhbHNTbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVzdGltb25pYWxzLXNsaWRlcicpO1xuICB2YXIgZ2FsbGVyeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5Jyk7XG4gIHZhciBuYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmF2LW1haW4nKTsgLy8gTW9kYWxcblxuICB2YXIgbW9kYWwgPSBmdW5jdGlvbiBtb2RhbCgpIHtcbiAgICB2YXIgb3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1vdmVybGF5Jyk7XG4gICAgbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHBvcHVwLmNsYXNzTGlzdC50b2dnbGUoJ21vZGFsLXNob3cnKTtcbiAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdycpO1xuICAgICAgbG9naW4uZm9jdXMoKTtcbiAgICB9KTtcbiAgICBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsLXNob3cnKTtcbiAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdycpO1xuICAgIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsLW92ZXJsYXknKSkge1xuICAgICAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RhbC1zaG93Jyk7XG4gICAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdycpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIG1vZGFsKCk7IC8vIEVORCBNb2RhbFxuICAvLyBTbGlkZXJzXG5cbiAgaWYgKHNsaWRlckNvbnRhaW5lcikge1xuICAgIHZhciBteVN3aXBlciA9IG5ldyBTd2lwZXIoJy5zd2lwZXItY29udGFpbmVyJywge1xuICAgICAgbG9vcDogdHJ1ZSxcbiAgICAgIHBhcmFsbGF4OiB0cnVlLFxuICAgICAgYXV0b3BsYXk6IHtcbiAgICAgICAgZGVsYXk6IDUwMDBcbiAgICAgIH0sXG4gICAgICBzcGVlZDogMTAwMCxcbiAgICAgIG1vdXNld2hlZWxDb250cm9sOiB0cnVlXG4gICAgfSk7XG4gIH1cblxuICBpZiAoYmxvZ1NsaWRlcikge1xuICAgIHZhciBzd2lwZXIgPSBuZXcgU3dpcGVyKCcuYmxvZy1zbGlkZXInLCB7XG4gICAgICBzcGFjZUJldHdlZW46IDMwLFxuICAgICAgZWZmZWN0OiAnZmFkZScsXG4gICAgICBsb29wOiB0cnVlLFxuICAgICAgZ3JhYkN1cnNvcjogdHJ1ZSxcbiAgICAgIGF1dG9wbGF5OiB7XG4gICAgICAgIGRlbGF5OiA3MDAwXG4gICAgICB9LFxuICAgICAgLy8gYXV0b0hlaWdodDogdHJ1ZSxcbiAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgZWw6ICcuYmxvZy1zbGlkZXJfX3BhZ2luYXRpb24nLFxuICAgICAgICBjbGlja2FibGU6IHRydWVcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGlmIChuZXdzU2xpZGVyKSB7XG4gICAgdmFyIG5ld3NTd2lwZXIgPSBuZXcgU3dpcGVyKCcubmV3cy1zbGlkZXInLCB7XG4gICAgICBlZmZlY3Q6ICdjb3ZlcmZsb3cnLFxuICAgICAgZ3JhYkN1cnNvcjogdHJ1ZSxcbiAgICAgIGxvb3A6IGZhbHNlLFxuICAgICAgY2VudGVyZWRTbGlkZXM6IGZhbHNlLFxuICAgICAga2V5Ym9hcmQ6IHRydWUsXG4gICAgICBzcGFjZUJldHdlZW46IDEwLFxuICAgICAgc2xpZGVzUGVyVmlldzogJzMnLFxuICAgICAgc3BlZWQ6IDMwMCxcbiAgICAgIGNvdmVyZmxvd0VmZmVjdDoge1xuICAgICAgICByb3RhdGU6IDAsXG4gICAgICAgIHN0cmV0Y2g6IDAsXG4gICAgICAgIGRlcHRoOiAwLFxuICAgICAgICBtb2RpZmllcjogMSxcbiAgICAgICAgc2xpZGVTaGFkb3dzOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIGJyZWFrcG9pbnRzOiB7XG4gICAgICAgIDEyMzA6IHtcbiAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAzXG4gICAgICAgIH0sXG4gICAgICAgIDkwMDoge1xuICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDJcbiAgICAgICAgfSxcbiAgICAgICAgNjUwOiB7XG4gICAgICAgICAgc2xpZGVzUGVyVmlldzogMSxcbiAgICAgICAgICBzcGFjZUJldHdlZW46IDAsXG4gICAgICAgICAgY2VudGVyZWRTbGlkZXM6IHRydWVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHNpbXVsYXRlVG91Y2g6IHRydWUsXG4gICAgICBuYXZpZ2F0aW9uOiB7XG4gICAgICAgIG5leHRFbDogJy5uZXdzLXNsaWRlci1uZXh0JyxcbiAgICAgICAgcHJldkVsOiAnLm5ld3Mtc2xpZGVyLXByZXYnXG4gICAgICB9LFxuICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICBlbDogJy5uZXdzLXNsaWRlcl9fcGFnaW5hdGlvbicsXG4gICAgICAgIGNsaWNrYWJsZTogdHJ1ZVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgaWYgKHRlc3RpbW9uaWFsc1NsaWRlcikge1xuICAgIHZhciBmZWVkU3dpcGVyID0gbmV3IFN3aXBlcih0ZXN0aW1vbmlhbHNTbGlkZXIsIHtcbiAgICAgIGF1dG9IZWlnaHQ6IHRydWUsXG4gICAgICBsb29wOiB0cnVlLFxuICAgICAgbmF2aWdhdGlvbjoge1xuICAgICAgICBuZXh0RWw6ICcuc3dpcGVyLWJ1dHRvbi1uZXh0JyxcbiAgICAgICAgcHJldkVsOiAnLnN3aXBlci1idXR0b24tcHJldidcbiAgICAgIH1cbiAgICB9KTtcbiAgfSAvLyBFTkQgU2xpZGVyc1xuICAvLyBNYXBcblxuXG4gIGlmIChtYXBDb250YWluZXIpIHtcbiAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICB2YXIgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKCdtYXAnLCB7XG4gICAgICAgIGNlbnRlcjogWzQ3LjUzOTYsIDQyLjAxNTFdLFxuICAgICAgICBjb250cm9sczogWyd0eXBlU2VsZWN0b3InLCAnZnVsbHNjcmVlbkNvbnRyb2wnLCAnZ2VvbG9jYXRpb25Db250cm9sJywgJ3J1bGVyQ29udHJvbCcsICdyb3V0ZUJ1dHRvbkNvbnRyb2wnXSxcbiAgICAgICAgem9vbTogMTZcbiAgICAgIH0pO1xuICAgICAgdmFyIGNvbnRyb2wgPSBteU1hcC5jb250cm9scy5nZXQoJ3JvdXRlQnV0dG9uQ29udHJvbCcpO1xuICAgICAgY29udHJvbC5yb3V0ZVBhbmVsLnN0YXRlLnNldCgnZnJvbScsICfQoNC+0LzQsNC90L7QstGB0LrQsNGPINGB0L7RjtC30L3Ri9C5IDk30LAnKTtcbiAgICAgIHZhciBteVBsYWNlbWFyayA9IG5ldyB5bWFwcy5QbGFjZW1hcmsoWzQ3LjUzOTgsIDQyLjAxNTNdLCB7XG4gICAgICAgIGhpbnRDb250ZW50OiAn0KPQuy4g0KHQvtGO0LfQvdCw0Y8gOTfQsCcsXG4gICAgICAgIGJhbGxvb25Db250ZW50OiAn0J/QvtC70LjQutC70LjQvdC40LrQsCdcbiAgICAgIH0sIHtcbiAgICAgICAgcHJlc2V0OiAnaXNsYW5kcyNibHVlTWVkaWNhbEljb24nXG4gICAgICB9KTtcbiAgICAgIG15TWFwLmdlb09iamVjdHMuYWRkKG15UGxhY2VtYXJrKTtcbiAgICB9O1xuXG4gICAgeW1hcHMucmVhZHkoaW5pdCk7XG4gIH0gLy8gRU5EIE1hcFxuICAvLyBUaW1lIHRvIGZvb3RlclxuXG5cbiAgZnVuY3Rpb24gYWRkVGltZUZvb3RlcigpIHtcbiAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICB5ZWFyOiAnbnVtZXJpYycsXG4gICAgICBtb250aDogJ2xvbmcnLFxuICAgICAgZGF5OiAnbnVtZXJpYydcbiAgICB9O1xuICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtZm9vdGVyLWluZm9fX2RhdGUnKTtcbiAgICBjb250YWluZXIuaW5uZXJIVE1MID0gZGF0ZS50b0xvY2FsZVN0cmluZygncnUnLCBvcHRpb25zKTtcbiAgfVxuXG4gIHNldFRpbWVvdXQoYWRkVGltZUZvb3RlciwgMTAwKTsgLy8gRU5EIFRpbWUgdG8gZm9vdGVyXG4gIC8vIFNpZGVtZW51XG5cbiAgaWYgKHdyYXBwZXJNZW51KSB3cmFwcGVyTWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICB3cmFwcGVyTWVudS5jbGFzc0xpc3QudG9nZ2xlKCdvcGVuJyk7XG4gICAgc2lkZW5hdi5jbGFzc0xpc3QudG9nZ2xlKCdzaG93Jyk7XG4gICAgb3ZlcmxheS5jbGFzc0xpc3QudG9nZ2xlKCdzaG93Jyk7XG4gIH0pO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnc2lkZW5hdi1vdmVybGF5JykpIHtcbiAgICAgIHdyYXBwZXJNZW51LmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKTtcbiAgICAgIHNpZGVuYXYuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdycpO1xuICAgICAgb3ZlcmxheS5jbGFzc0xpc3QudG9nZ2xlKCdzaG93Jyk7XG4gICAgfVxuICB9KTsgLy8gRU5EIFNpZGVtZW51XG4gIC8vIGFjY29yZGlvblxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYWNjLmxlbmd0aDsgaSsrKSB7XG4gICAgYWNjW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIC8qIFRvZ2dsZSBiZXR3ZWVuIGFkZGluZyBhbmQgcmVtb3ZpbmcgdGhlIFwiYWN0aXZlXCIgY2xhc3MsXG4gICAgICB0byBoaWdobGlnaHQgdGhlIGJ1dHRvbiB0aGF0IGNvbnRyb2xzIHRoZSBwYW5lbCAqL1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcbiAgICAgIC8qIFRvZ2dsZSBiZXR3ZWVuIGhpZGluZyBhbmQgc2hvd2luZyB0aGUgYWN0aXZlIHBhbmVsICovXG5cbiAgICAgIHZhciBwYW5lbCA9IHRoaXMubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgcGFuZWwuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XG4gICAgfSk7XG4gIH0gLy8gRU5EIEFjY29yZGlvblxuICAvLyBwZW9wbGVDYXJkXG5cblxuICBmdW5jdGlvbiBwZW9wbGVDYXJkKCkge1xuICAgIHZhciBwZW9wbGVDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1hdGVyaWFsLWNhcmQgPiAubWMtYnRuLWFjdGlvbicpO1xuXG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHBlb3BsZUNhcmQubGVuZ3RoOyBfaSsrKSB7XG4gICAgICBwZW9wbGVDYXJkW19pXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNhcmQgPSB0aGlzLnBhcmVudE5vZGU7XG4gICAgICAgIHZhciBpY29uID0gdGhpcy5xdWVyeVNlbGVjdG9yKCdpJyk7XG4gICAgICAgIGljb24uY2xhc3NMaXN0LmFkZCgnZmEtc3Bpbi1mYXN0Jyk7XG5cbiAgICAgICAgaWYgKGNhcmQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtYy1hY3RpdmUnKSkge1xuICAgICAgICAgIGNhcmQuY2xhc3NMaXN0LnJlbW92ZSgnbWMtYWN0aXZlJyk7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2ZhLWFycm93LWxlZnQnKTtcbiAgICAgICAgICAgIGljb24uY2xhc3NMaXN0LnJlbW92ZSgnZmEtc3Bpbi1mYXN0Jyk7XG4gICAgICAgICAgICBpY29uLmNsYXNzTGlzdC5hZGQoJ2ZhLWJhcnMnKTtcbiAgICAgICAgICB9LCA4MDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNhcmQuY2xhc3NMaXN0LmFkZCgnbWMtYWN0aXZlJyk7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2ZhLWJhcnMnKTtcbiAgICAgICAgICAgIGljb24uY2xhc3NMaXN0LnJlbW92ZSgnZmEtc3Bpbi1mYXN0Jyk7XG4gICAgICAgICAgICBpY29uLmNsYXNzTGlzdC5hZGQoJ2ZhLWFycm93LWxlZnQnKTtcbiAgICAgICAgICB9LCA4MDApO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwZW9wbGVDYXJkKCk7IC8vIEVORCBQZW9wbGVDYXJkXG4gIC8vIEdhbGxlcnlcblxuICBpZiAoZ2FsbGVyeSkge1xuICAgIGJhZ3VldHRlQm94LnJ1bignLmdhbGxlcnktd3JhcCcsIHtcbiAgICAgIGFzeW5jOiB0cnVlXG4gICAgfSk7XG4gIH0gLy8gRU5EIEdhbGxlcnlcbiAgLy8gRm9ybVN1Ym1pdFxuXG5cbiAgdmFyIGZvcm1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZm9ybScpO1xuXG4gIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKF9pMikge1xuICAgIGZvcm1zW19pMl0ub25zdWJtaXQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIGZvcm1zW19pMl0uY2xhc3NMaXN0LmFkZCgnc2lnbmVkJyk7XG4gICAgfTtcbiAgfTtcblxuICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBmb3Jtcy5sZW5ndGg7IF9pMisrKSB7XG4gICAgX2xvb3AoX2kyKTtcbiAgfSAvLyBFTkQgRm9ybVN1Ym1pdFxuICAvLyBGaXhlZE5hdlxuXG5cbiAgdmFyIHRvcE9mTmF2ID0gbmF2Lm9mZnNldFRvcDtcblxuICBmdW5jdGlvbiBmaXhOYXYoKSB7XG4gICAgaWYgKHdpbmRvdy5zY3JvbGxZID49IHRvcE9mTmF2KSB7XG4gICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnBhZGRpbmdUb3AgPSBuYXYub2Zmc2V0SGVpZ2h0ICsgJ3B4JztcbiAgICAgIG5hdi5jbGFzc0xpc3QuYWRkKCdmaXhlZC1uYXYnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmF2LmNsYXNzTGlzdC5yZW1vdmUoJ2ZpeGVkLW5hdicpO1xuICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5wYWRkaW5nVG9wID0gMDtcbiAgICB9XG4gIH1cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgZml4TmF2KTsgLy8gRU5EIEZpeGVkTmF2XG4gIC8vIE1lbnUgZHJvcGRvd25cblxuICB2YXIgZHJvcGRvd25JdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5maXhlZC13aWR0aCcpO1xuXG4gIHZhciBfbG9vcDIgPSBmdW5jdGlvbiBfbG9vcDIoX2kzKSB7XG4gICAgZHJvcGRvd25JdGVtc1tfaTNdLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgICAgdmFyIHN1Yk1lbnUgPSBkcm9wZG93bkl0ZW1zW19pM10ucXVlcnlTZWxlY3RvcignLm1lbnUnKTtcblxuICAgICAgICBkcm9wZG93bkl0ZW1zW19pM10uY2xhc3NMaXN0LnRvZ2dsZSgnZml4ZWQtd2lkdGgtLXNob3cnKTtcblxuICAgICAgICBzdWJNZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc3ViTWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBmb3IgKHZhciBfaTMgPSAwOyBfaTMgPCBkcm9wZG93bkl0ZW1zLmxlbmd0aDsgX2kzKyspIHtcbiAgICBfbG9vcDIoX2kzKTtcbiAgfSAvLyBFTkQgTWVudSBkcm9wZG93blxuICAvLyBCbGluZFxuXG5cbiAgdmFyIGJsaW5kdHJpZ2dlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1zdGFyYmxpbmQtdHJpZ2dlcicpO1xuICB2YXIgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcbiAgdmFyIHNsaWRlck5ld3NCbGluZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1zbGlkZXJOZXdzLS1ibGluZCcpO1xuICB2YXIgdGVzdGltb25hbHNCbGluZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1ibGluZFRlc3RpbW9uaWFscycpO1xuICB2YXIgYmxpbmRQYW5lbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1ibGluZEhlYWRlclBhbmVsJyk7XG4gIGJsaW5kdHJpZ2dlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYmxpbmQnLCAnYWN0aXZlJyk7XG4gICAgYmxpbmRQYW5lbC5jbGFzc0xpc3QudG9nZ2xlKCdibGluZEhlYWRlclBhbmVsLS1zaG93Jyk7XG4gICAgYm9keS5jbGFzc0xpc3QudG9nZ2xlKCdzdGFyYmxpbmQnKTtcblxuICAgIGlmICh0ZXN0aW1vbmFsc0JsaW5kKSB7XG4gICAgICB0ZXN0aW1vbmFsc0JsaW5kLmNsYXNzTGlzdC50b2dnbGUoJ2NkLXRlc3RpbW9uaWFsc19fYmxpbmQtLXNob3cnKTtcbiAgICB9XG5cbiAgICBpZiAoc2xpZGVyTmV3c0JsaW5kKSB7XG4gICAgICBmb3IgKHZhciBfaTQgPSAwOyBfaTQgPCBzbGlkZXJOZXdzQmxpbmQubGVuZ3RoOyBfaTQrKykge1xuICAgICAgICBzbGlkZXJOZXdzQmxpbmRbX2k0XS5jbGFzc0xpc3QudG9nZ2xlKCdibGluZFNsaWRlck5ld3MtLXNob3cnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0ZXN0KCk7XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIHRlc3QoKSB7XG4gICAgaWYgKGJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKCdzdGFyYmxpbmQnKSkge1xuICAgICAgdmFyIGJ1dHRvbnMgPSBfdG9Db25zdW1hYmxlQXJyYXkoYmxpbmRQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24nKSk7XG5cbiAgICAgIGJ1dHRvbnMuZm9yRWFjaChmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoYnV0dG9uLmhhc0F0dHJpYnV0ZSgnZGF0YS12YWx1ZScpKSB7XG4gICAgICAgICAgICBib2R5LmNsYXNzTGlzdC50b2dnbGUoYnV0dG9uLmdldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59KTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGJhY2tUb3AgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdqcy1jZC10b3AnKVswXTtcbiAgdmFyIG9mZnNldCA9IDMwMDtcbiAgdmFyIG9mZnNldE9wYWNpdHkgPSAxMjAwO1xuICB2YXIgc2Nyb2xsRHVyYXRpb24gPSA3MDA7XG4gIHZhciBzY3JvbGxpbmcgPSBmYWxzZTtcblxuICBpZiAoYmFja1RvcCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGlmICghc2Nyb2xsaW5nKSB7XG4gICAgICAgIHNjcm9sbGluZyA9IHRydWU7XG4gICAgICAgICF3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lID8gc2V0VGltZW91dChjaGVja0JhY2tUb1RvcCwgMjUwKSA6IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2hlY2tCYWNrVG9Ub3ApO1xuICAgICAgfVxuICAgIH0pOyAvL3Ntb290aCBzY3JvbGwgdG8gdG9wXG5cbiAgICBiYWNrVG9wLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgIXdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPyB3aW5kb3cuc2Nyb2xsVG8oMCwgMCkgOiBzY3JvbGxUb3Aoc2Nyb2xsRHVyYXRpb24pO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gY2hlY2tCYWNrVG9Ub3AoKSB7XG4gICAgdmFyIHdpbmRvd1RvcCA9IHdpbmRvdy5zY3JvbGxZIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XG4gICAgd2luZG93VG9wID4gb2Zmc2V0ID8gYWRkQ2xhc3MoYmFja1RvcCwgJ2NkLXRvcC0tc2hvdycpIDogcmVtb3ZlQ2xhc3MoYmFja1RvcCwgJ2NkLXRvcC0tc2hvdycsICdjZC10b3AtLWZhZGUtb3V0Jyk7XG4gICAgd2luZG93VG9wID4gb2Zmc2V0T3BhY2l0eSAmJiBhZGRDbGFzcyhiYWNrVG9wLCAnY2QtdG9wLS1mYWRlLW91dCcpO1xuICAgIHNjcm9sbGluZyA9IGZhbHNlO1xuICB9XG5cbiAgZnVuY3Rpb24gc2Nyb2xsVG9wKGR1cmF0aW9uKSB7XG4gICAgdmFyIHN0YXJ0ID0gd2luZG93LnNjcm9sbFkgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICB2YXIgY3VycmVudFRpbWUgPSBudWxsO1xuXG4gICAgdmFyIGFuaW1hdGVTY3JvbGwgPSBmdW5jdGlvbiBhbmltYXRlU2Nyb2xsKHRpbWVzdGFtcCkge1xuICAgICAgaWYgKCFjdXJyZW50VGltZSkgY3VycmVudFRpbWUgPSB0aW1lc3RhbXA7XG4gICAgICB2YXIgcHJvZ3Jlc3MgPSB0aW1lc3RhbXAgLSBjdXJyZW50VGltZTtcbiAgICAgIHZhciB2YWwgPSBNYXRoLm1heChNYXRoLmVhc2VJbk91dFF1YWQocHJvZ3Jlc3MsIHN0YXJ0LCAtc3RhcnQsIGR1cmF0aW9uKSwgMCk7XG4gICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgdmFsKTtcblxuICAgICAgaWYgKHByb2dyZXNzIDwgZHVyYXRpb24pIHtcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlU2Nyb2xsKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlU2Nyb2xsKTtcbiAgfVxuXG4gIE1hdGguZWFzZUluT3V0UXVhZCA9IGZ1bmN0aW9uICh0LCBiLCBjLCBkKSB7XG4gICAgdCAvPSBkIC8gMjtcbiAgICBpZiAodCA8IDEpIHJldHVybiBjIC8gMiAqIHQgKiB0ICsgYjtcbiAgICB0LS07XG4gICAgcmV0dXJuIC1jIC8gMiAqICh0ICogKHQgLSAyKSAtIDEpICsgYjtcbiAgfTsgLy9jbGFzcyBtYW5pcHVsYXRpb25zIC0gbmVlZGVkIGlmIGNsYXNzTGlzdCBpcyBub3Qgc3VwcG9ydGVkXG5cblxuICBmdW5jdGlvbiBoYXNDbGFzcyhlbCwgY2xhc3NOYW1lKSB7XG4gICAgaWYgKGVsLmNsYXNzTGlzdCkgcmV0dXJuIGVsLmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO2Vsc2UgcmV0dXJuICEhZWwuY2xhc3NOYW1lLm1hdGNoKG5ldyBSZWdFeHAoXCIoXFxcXHN8XilcIi5jb25jYXQoY2xhc3NOYW1lLCBcIihcXFxcc3wkKVwiKSkpO1xuICB9XG5cbiAgZnVuY3Rpb24gYWRkQ2xhc3MoZWwsIGNsYXNzTmFtZSkge1xuICAgIHZhciBjbGFzc0xpc3QgPSBjbGFzc05hbWUuc3BsaXQoJyAnKTtcbiAgICBpZiAoZWwuY2xhc3NMaXN0KSBlbC5jbGFzc0xpc3QuYWRkKGNsYXNzTGlzdFswXSk7ZWxzZSBpZiAoIWhhc0NsYXNzKGVsLCBjbGFzc0xpc3RbMF0pKSBlbC5jbGFzc05hbWUgKz0gXCIgXCIuY29uY2F0KGNsYXNzTGlzdFswXSk7XG4gICAgaWYgKGNsYXNzTGlzdC5sZW5ndGggPiAxKSBhZGRDbGFzcyhlbCwgY2xhc3NMaXN0LnNsaWNlKDEpLmpvaW4oJyAnKSk7XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmVDbGFzcyhlbCwgY2xhc3NOYW1lKSB7XG4gICAgdmFyIGNsYXNzTGlzdCA9IGNsYXNzTmFtZS5zcGxpdCgnICcpO1xuICAgIGlmIChlbC5jbGFzc0xpc3QpIGVsLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NMaXN0WzBdKTtlbHNlIGlmIChoYXNDbGFzcyhlbCwgY2xhc3NMaXN0WzBdKSkge1xuICAgICAgdmFyIHJlZyA9IG5ldyBSZWdFeHAoXCIoXFxcXHN8XilcIi5jb25jYXQoY2xhc3NMaXN0WzBdLCBcIihcXFxcc3wkKVwiKSk7XG4gICAgICBlbC5jbGFzc05hbWUgPSBlbC5jbGFzc05hbWUucmVwbGFjZShyZWcsICcgJyk7XG4gICAgfVxuICAgIGlmIChjbGFzc0xpc3QubGVuZ3RoID4gMSkgcmVtb3ZlQ2xhc3MoZWwsIGNsYXNzTGlzdC5zbGljZSgxKS5qb2luKCcgJykpO1xuICB9XG59KSgpOyJdfQ==
